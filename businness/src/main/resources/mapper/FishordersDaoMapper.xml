<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.businness.mapper.FishordersDaoMapper">
    <select id="queryAll" resultType="com.businness.entity.FishordersEX">
        select * from fishorders
        <trim prefixOverrides="and|or" prefix="where">
            <if test="otime!=null and otime!=''">
                and ordertime  BETWEEN CONCAT(#{otime},' 00:00:00') AND CONCAT(#{ptime},' 23:59:59')
            </if>
            <if test="statos!=null and statos!=''">
                and statos=#{statos}
            </if>
            <if test="nameofadvertiser!=null and nameofadvertiser!=''">
                and nameofadvertiser concat('%',#{nameofadvertiser},'%')
            </if>
            <if test="channel!=null and channel!=''">
                and channel like concat('%',#{channel},'%')
            </if>
        </trim>
    </select>

    <insert id="insertOneEx" parameterType="com.businness.entity.FishordersEX">
            insert fishorders(`workid`,`channel`,`flow`,`phone`,`name`,`idcard`,`interior`,`accept`,`servicename`,`uploginno`,`statos`,`amount`,`ordertime`,`payment`,`remark`,`toproomotelinks`,`nameofadvertiser`,`address`,`appointmentime`,`ok`,`trackingtime`,`failure`,`uplogintime`,`broadband`)
            value (#{workid},#{channel},#{flow},#{phone},#{name},#{idcard},#{interior},#{accept},#{servicename},#{uploginno},#{statos},#{amount},#{ordertime},#{payment},#{remark},#{toproomotelinks},#{nameofadvertiser},#{address},null,0,#{trackingtime},#{failure},#{uplogintime},#{broadband})
    </insert>

    <select id="fishcount" resultType="java.util.Map">
        SELECT address,count(address) from fishorders
        <trim prefixOverrides="and|or" prefix="where">
            <if test="otime!=null and otime!=''">
                and ordertime BETWEEN CONCAT(#{otime},' 00:00:00') AND CONCAT(#{ptime},' 23:59:59')
            </if>
        </trim>
        GROUP BY address
    </select>
</mapper>